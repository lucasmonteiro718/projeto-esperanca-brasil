// Fundação Esperança Brasil - Interatividade Completa
document.addEventListener("DOMContentLoaded", () => {
  const menuToggle = document.querySelector("#menu-toggle");
  const nav = document.querySelector("nav");
  const darkModeToggle = document.querySelector("#dark-mode-toggle");
  const main = document.querySelector("main");

  // Menu responsivo
  if (menuToggle && nav) {
    menuToggle.addEventListener("click", () => {
      nav.classList.toggle("active");
    });
  }

  // Modo escuro
  if (darkModeToggle) {
    darkModeToggle.addEventListener("click", () => {
      document.body.classList.toggle("dark-mode");
      localStorage.setItem("darkMode", document.body.classList.contains("dark-mode"));
    });

    if (localStorage.getItem("darkMode") === "true") {
      document.body.classList.add("dark-mode");
    }
  }

  // SPA simples (Single Page Application)
  const links = document.querySelectorAll("nav a");
  links.forEach(link => {
    link.addEventListener("click", e => {
      const href = link.getAttribute("href");
      if (href.endsWith(".html")) {
        e.preventDefault();
        fetch(href)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const doc = parser.parseFromString(html, "text/html");
            main.innerHTML = doc.querySelector("main").innerHTML;
            window.history.pushState({}, "", href);
          })
          .catch(() => {
            main.innerHTML = "<h2>Erro ao carregar página.</h2>";
          });
      }
    });
  });

  // Validação de formulário
  document.querySelectorAll("form").forEach(form => {
    form.addEventListener("submit", e => {
      let valido = true;
      form.querySelectorAll("[required]").forEach(campo => {
        if (!campo.value.trim()) {
          campo.classList.add("erro");
          valido = false;
        } else campo.classList.remove("erro");
      });
      if (!valido) {
        e.preventDefault();
        alert("⚠️ Preencha todos os campos obrigatórios.");
      }
    });
  });
});
